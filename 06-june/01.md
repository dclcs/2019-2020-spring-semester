# June 1^st^, 2020

## SE-340::HCI

今日话题：VR 空间定位技术。

> 上节课我们聊到了，既然 VR 的目的需要制造一个沉浸式的世界，那么定位就变成了虚拟世界和现实世界交汇的重要技术点。

### Locating

#### Global, Outdoor

> 这种定位方式精度普遍不高，但覆盖范围广，成本（指发射卫星、架设基站的成本）极高。

这里的全球室外定位技术主要包括下面几类：

##### Satellite-based

基于卫星信号发射的室外大空间定位技术。

能发射卫星的各国都有制造自己的 GNSS（Global Navigating Satellite System）的计划。

最有名的就是美国的 GPS 啦。

##### Ground-based

当然，除了天基方式，还有别的地基方式可以用于全球定位，比如利用 IP 位址就能大概判断位置（非常粗略，有时候还会跑偏）。

另外，移动基站的分布密集、信号交互快，也是用于粗粒度定位的好办法。

#### Local, Indoor

> 这种定位方式对于覆盖范围要求不高，一般覆盖一栋建筑物的室内几个房间就足够了。但是对精度的要求很高，且应该具有一定的室内布局抗干扰能力。
>
> 成本相较于卫星、基站来说当然是很低了。

##### Infrared Locating

通过发射人眼不可见的红外光来实现室内定位。

###### Ranking

![螢幕快照 2020-06-01 上午7.43.25](01.assets/螢幕快照 2020-06-01 上午7.43.25.png)

###### Physical Laws

红外光作为相对高频率的电磁波，其主要体现出光的粒子性，即抗干扰能力很弱，几乎无法穿透障碍物和干扰。

因此，布局时为了避开障碍物就需要很复杂的设计。

但也正好是因为其基本沿直线传播，几乎不发生弯曲和受干扰（一受干扰信号就传不过来了），精确度可以高到毫米级别。

其具体实现方法呢？有类似于 GNSS 的主动发射 + 终端计算式；也有用多对密集发射器发射正交光束，形成一张覆盖全空间的坐标网格，只需要通过收集到发射器的 ID 就能实现定位。

总的来说，红外线发射器并不贵（各种遥控器就运用了这一技术）。所以这类系统的成本也是不高的。

###### Example

HTC Lighthouse 就利用了红外激光定位技术，实现了高精度、广角度的定位 Demo。

其定位方式是红外光源会在两个方向之间来回快速扫动，每经过一个 Tick 会在光线的特定位置插入当前红外光源的发射倾角信息。受信终端只要得到了这一信息，就可以反推算出具体的位置。

其定位范围广达 15 × 15 英尺^2^，精度可达 1 毫米。

同时，因为所有需要处理的数据只是获取红外线的时间，和图像完全无关，因此如此小的计算量完全可以放在接收设备固件中完成。

至于缺点也相当明显：带有高速高频旋转的发射器肯定无法长久、稳定、且精确地工作，可靠性存在问题。而且，基站本身也需要进行安装、校准，成本和复杂度也很高。

> 总而言之，这就是个 Demo（逃

##### Ultrasound Locating

通过发射超声波来实现定位。

这里的超声波指的是频率超过人的听觉上阈，即 20000 Hz 的声波。它也和红外线一样具有方向性好、衰减小、对人无干扰等特征；但其穿透障碍物的能力也还是很弱。

###### Ranking

![image-20200601080418324](01.assets/image-20200601080418324.png)

###### Physical Laws

由于超声波的频率很低，我们不需要特定地指定一个超声波的方向，他自然会以包络面的形式广播扩散出去。

因此，我们没法使用 Lighthouse 的「快速旋转并发射角度信息」的策略，因为这个信息是被向所有方向广播的。

但同时，由于超声波的传播速率（相对于光速而言）慢很多，我们可以直接用「发信至收信」的耗时来测算距离。

所以，我们可以在被测位置装上「一收到超声波就马上 `echo` 一个超声波」的仪器，这样的信息传回发射器就能进行测距了。或者，直接在那放一个反射性强的物体，把声波原样反射回来（当然，这样衰减就不能看了，传不传得回去都是个问题。）

只有一个距离分量还不足够用于定位，但是理论上最少三个发射器就足够实现点定位了。

###### Pros

因为超声波的广播效果不如红外光的几乎直线传播好，因此精度略逊于红外光定位，但也能达到厘米级。

而且，由于声波本身的广播性，我们无须制造一个不停旋转的机械装置，结构简单，也就延长了寿命。

另外，声波还有一定的穿透性，虽然会吃到很多衰减。

###### Cons

致命缺陷：超声波的波速和空气压力和温度有关（纵波嘛），所以精度没法保证。

另外，随着包络面半径的扩大，其强度也会迅速衰减，大型场合用不了。

##### RFID Locating

RFID（**R**adio **F**requency **ID**entification），即射频识别。

###### Ranking

![image-20200601082025206](01.assets/image-20200601082025206.png)

###### Physical Laws

仿照地面波电视频道的原理，通过射频的方式把信息传播出去。不过这里是相当小规模的版本；传不了多远；但用于室内定位足够了。

###### Pros

几毫秒內完成；因为电磁波传播速度快。

需要的设备也不复杂，对应技术已经很成熟（例如 NFC 就是基于这一技术的产物）。

###### Cons

作用距离太近了，实用价值有限；且抗干扰能力不强；不便于系统的整合。

##### Bluetooth Locating

蓝牙定位。

###### Ranking

![image-20200601082842020](01.assets/image-20200601082842020.png)

###### Physical Laws

蓝牙 4.0 引入了 Beacon 广播功能，可以向一定空间内主动广播报文。

这一报文会同时包含发射的功率信息；而巧妙的是，功率衰减和传播距离具有强相关性。然后，事情就变成了 Ultrasound Locating 了；引入多台基站三角定位即可。

更妙的是，蓝牙 5.0 标准还增加了寻向功能，终端可以得知报文来源的方向；这样就不需要多台基站三角定位了。

###### Pros

设备体积小，距离短，功耗低。

不需要特殊的终端；只要是个智能设备都该有蓝牙吧？

而且，蓝牙传输不受视距限制。

###### Cons

空间复杂的情况下，蓝牙系统稳定性稍微差一点；但也还行。

如果空间中存在噪声信息，那么蓝牙就完全没法用。

而且，虽然蓝牙接收模块很便宜也很常见，但是蓝牙广播设备还是相对比较贵的。

##### Wi-fi Locating

###### Ranking

![image-20200601083607645](01.assets/image-20200601083607645.png)

###### Physical Laws

和蓝牙类似，Wi-Fi 的连接和维系也是基于广播的。只不过，其主要着重于抗干扰性，但精确度却很差。

实现原理也是多个 Wi-Fi 广播，三角定位。

###### Pros

优点当然是极低的硬件成本，无论是客户端还是广播端。

###### Cons

太多了…室内精度仅有两米，几乎没法用。

适用范围很窄…

##### ZigBee Locating

###### Ranking

![image-20200601084523625](01.assets/image-20200601084523625.png)

###### Physical Laws

这是超级魔幻的一种定位方式。

既然人类已经组建起了网络，那么网络本身传输的延迟速率也可以用来定位。

注意，节点之间可能是由 Wi-Fi 连接的，也可能是有线网络，甚至是高速光纤通信。在具有这些全部信息之後，就可以利用 RSSI（接受讯号强度指标）来定位了。

###### Pros

低功耗、低成本。这是一个基于现存系统的附加件，创意极佳。

###### Cons

多径效应：由 A 点到 B 点，有多条可能的路径可以选择，而他们可能有着不同的传播速率；这就会导致误差。

另外，稍微移动一点都可能导致信号传输速率大幅度变化。

##### UWB Locating

所谓的 UWB，即 Ultra Wideband，超宽带（直译）。

###### Ranking

![image-20200601090318570](01.assets/image-20200601090318570.png)

近乎完美的室内定位技术。

###### Physical Laws

也是基于测距 + 三角定位的套路。事先做好发射器的布局，新加入的盲节点只需要和三个节点通信就可以获知其位置。

只不过，UWB 的穿透性和抗干扰性太好，以至于其精度非常高，甚至能达到红外定位的效果。

###### Pros

* 毫米级精度
* 安全性高
* 系统复杂度低
* 穿透力强

###### Cons

贵。需要预先布局，成本极高。

##### Image Locating (3D)

利用计算机双目视觉，粗略地重建出当前摄像机所观察到的立体空间部分；然后，和服务器中保存的高精度室内模型做比对，反推出视觉位置。

###### Pros & Cons

优点很明显：不需要额外加入特殊设备，成本低，完全是软件的工作。

缺点也很明显：一旦存在遮挡干扰，就没了。只能够视距传播。

> 除非我们外加设备：红外／紫外传感器等等…

##### Electic-Magnetic Locating

###### Ranking

![image-20200601091150957](01.assets/image-20200601091150957.png)

###### Physical Laws

给三个正交方向的线圈通电，产生磁场；同时在定位目标点放三个正交方向的被动线圈。

被动线圈中的感应电流正比于其和主动线圈的距离。因此我们就可以通过三个方向被动线圈的感应电流强度反推其同发射点的 $x$、$y$、$z$ 距离；这不就得了。

###### Pros

没有遮挡问题，不受视距限制。直接以「场」的形式传递信息。

价格很低，工作范围大，采样率高。

###### Cons

精度不高；而且其他的电子设备会对磁场产生较强的干扰。

另外，延迟比较大；主要是因为产生感应磁场、产生感应电流都需要时间。

### Q & A

#### Question 1

上面的这些定位方式中，「不受视距限制」多次出现。那么视距究竟是什么？

#### Answer 1

简单说，「能定位的物体都是可以被直接看见的」就是「受视距限制」；而「能定位到不能被直接看到的物体」就是「不受视距限制」。

